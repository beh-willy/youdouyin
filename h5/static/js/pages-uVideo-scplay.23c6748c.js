(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-uVideo-scplay"],{"3aec":function(t,i,e){"use strict";var n=e("288e");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=n(e("e814")),a=n(e("cebc")),o=n(e("5ede")),l=n(e("da3e")),c=n(e("4455")),u=n(e("b8fa")),d=e("2f62"),r=null,v={data:function(){return{page:1,videoIndex:0,vlist:[],isPlay:!0,clickNum:0,isLike:!1,currentTabIndex:0}},computed:(0,a.default)({},(0,d.mapState)(["user","token"])),components:{videoCart:l.default,videoComment:c.default},onLoad:function(t){if(!this.user)return uni.reLaunch({url:"../auth/login"}),!1;this.getvideolist(),t.index&&(this.videoIndex=(0,s.default)(t.index))},onReady:function(){},methods:{touserhome:function(t){console.log(t),uni.navigateTo({url:"/pages/ucenter/uhome?id="+t})},shares:function(){uni.navigateTo({url:"/pages/share/share"})},tofllist:function(){uni.switchTab({url:"/pages/uVideo/fenlei"})},getvideolist:function(){var t=this;o.default.request({url:"service=Community.getCollectLists",method:"POST",data:{token:this.user.token,uid:this.user.id,p:this.page}}).then(function(i){0==i.data.data.code&&(1==t.page?t.vlist=i.data.data.info:t.vlist=t.vlist.concat(i.data.data.info),t.init())}).catch(function(t){})},handleTabbar:function(t){this.currentTabIndex=t},init:function(){var t=this;this.videoContextList=[];for(var i=0;i<this.vlist.length;i++)this.videoContextList.push(uni.createVideoContext("myVideo"+i,this));setTimeout(function(){t.play(t.videoIndex)},500)},isFiveMultiply:function(t){return t%5===0},handleSlider:function(t){var i=t.detail.current;1==this.isFiveMultiply(i)&&(this.page=this.page+1,this.getvideolist(this.id)),this.videoIndex>=0&&(this.videoContextList[this.videoIndex].pause(),this.videoContextList[this.videoIndex].seek(0),this.isPlay=!1),i===this.videoIndex+1?this.play(this.videoIndex+1):i===this.videoIndex-1&&this.play(this.videoIndex-1),this.videoIndex=i,this.setclick(i)},setclick:function(t){if(!this.user)return!1;1==this.isPlay&&o.default.request({url:"service=Video.addView",method:"POST",data:{token:this.user.token,videoid:this.vlist[t].id,random_str:(0,u.default)(this.user.id+"-"+this.vlist[t].id+"-#2hgfk85cm23mk58vncsark"),uid:this.user.id}}).then(function(t){}).catch(function(t){})},play:function(t){var i=this.$refs.uniPop,e=this;this.vlist[t].price>0?i.show({skin:"H5",content:"观看次视频需要消耗"+this.vlist[t].price+"金币",btns:[{text:"取消",onTap:function(){i.close(),e.pause(t)}},{text:"确定",style:"color: #feb719",onTap:function(){e.byvideo(t),i.close()}}]}):(this.videoContextList[t].play(),this.isPlay=!0)},pause:function(t){this.videoContextList[t].pause(),this.isPlay=!1},byvideo:function(t){var i=this;o.default.request({url:"service=Video.buyVideo",method:"POST",data:{token:this.user.token,videoid:this.vlist[t].id,random_str:(0,u.default)(this.user.id+"-"+this.vlist[t].id+"-#2hgfk85cm23mk58vncsark"),uid:this.user.id}}).then(function(e){0==e.data.data.code?(i.videoContextList[t].play(),i.isPlay=!0,i.vlist[t].price=0):uni.showToast({title:e.data.data.msg,icon:"none"})}).catch(function(t){})},handleClicked:function(t){var i=this;r&&clearTimeout(r),this.clickNum++,r=setTimeout(function(){i.clickNum>=2||(i.isPlay?i.pause(t):i.play(t)),i.clickNum=0},300)},handleAttention:function(t){var i=this.vlist,e=this.userInfo;o.default.request({url:"service=User.setAttent",method:"POST",data:{uid:this.user.id,token:this.user.token,touid:i[t].uid}}).then(function(n){0==n.data.data.info[0].isattent?i[t].isattent=0:i[t].isattent=1;for(var s=0,a=0;a<=i.length;a++)1==i[a].isattent&&(s+=1),e.follows=s}).catch(function(t){})},handleIsLike:function(t){0==this.vlist[t].islike?(this.vlist[t].islike=1,this.vlist[t].likes=(0,s.default)(this.vlist[t].likes)-1):(this.vlist[t].islike=0,this.vlist[t].likes=(0,s.default)(this.vlist[t].likes)+1),0==this.vlist[t].islike&&o.default.request({url:"service=video.addLike",method:"POST",data:{token:this.user.token,videoid:this.vlist[t].id,uid:this.user.id}}).then(function(t){}).catch(function(t){})},handleVideoComment:function(t){this.$refs.videoComment.show(t)},handleVideoCart:function(t){this.$refs.videoCart.show(t)}}};i.default=v},4337:function(t,i,e){"use strict";var n,s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"uni__container uni__videopage flexbox flex_col"},[e("header-bar",{attrs:{isBack:!0,title:" ",bgColor:{background:"transparent"},center:!0,transparent:!0}},[e("v-uni-text",{staticClass:"uni_btnIco iconfont icon-hot",attrs:{slot:"back"},slot:"back"})],1),e("v-uni-view",{staticClass:"uni__scrollview flex1"},[e("v-uni-swiper",{staticStyle:{height:"100%"},attrs:{"indicator-dots":!1,duration:200,vertical:!0,current:t.videoIndex},on:{change:function(i){arguments[0]=i=t.$handleEvent(i),t.handleSlider.apply(void 0,arguments)}}},[t._l(t.vlist,function(i,n){return[e("v-uni-swiper-item",[e("v-uni-view",{staticClass:"uni_vdplayer"},[e("v-uni-video",{ref:"myVideo"+n,refInFor:!0,staticClass:"player-video",attrs:{"x5-video-player-type":"h5","x5-video-player-fullscreen":"true",id:"myVideo"+n,src:i.href,controls:!1,loop:!0,"show-center-play-btn":!1,objectFit:"fill"}}),e("v-uni-view",{staticClass:"vd-cover flexbox",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handleClicked(n)}}},[t.isPlay?t._e():e("v-uni-text",{staticClass:"iconfont icon-bofang"})],1),e("v-uni-view",{staticClass:"vd-footToolbar flexbox flex_alignb"},[e("v-uni-view",{staticClass:"vd-info flex1"},[e("v-uni-view",{staticClass:"item at"},t._l(i.cate,function(i,n){return e("v-uni-view",{key:n,staticClass:"kw",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.tofllist.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"bold fs_18 mr_5"},[t._v("＃")]),t._v(t._s(i.name))],1)}),1),e("v-uni-view",{staticClass:"item subtext"},[t._v(t._s(i.title))]),e("v-uni-view",{staticClass:"item uinfo flexbox flex_alignc"},[e("v-uni-image",{staticClass:"avator",attrs:{src:i.userinfo.avatar,mode:"aspectFill"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.touserhome(i.userinfo.id)}}}),e("v-uni-text",{staticClass:"name"},[t._v(t._s(i.userinfo.user_nicename))]),e("v-uni-text",{staticClass:"btn-attention bg_linear1",class:1==i.isattent?"on":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handleAttention(n)}}},[t._v(t._s(1==i.isattent?"已关注":"关注"))])],1),e("v-uni-view",{staticClass:"item reply",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handleVideoComment(n)}}},[e("v-uni-text",{staticClass:"iconfont icon-pinglun mr_5"}),t._v("写评论...")],1)],1),e("v-uni-view",{staticClass:"vd-sidebar"},[i.cart?e("v-uni-view",{staticClass:"ls cart flexbox bg_linear3",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handleVideoCart(n)}}},[e("v-uni-text",{staticClass:"iconfont icon-cart"})],1):t._e(),e("v-uni-view",{staticClass:"ls",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handleIsLike(n)}}},[e("v-uni-text",{staticClass:"iconfont icon-like",class:0==i.islike?"like":""}),e("v-uni-text",{staticClass:"num"},[t._v(t._s(i.likes))])],1),e("v-uni-view",{staticClass:"ls",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handleVideoComment(n)}}},[e("v-uni-text",{staticClass:"iconfont icon-liuyan"}),e("v-uni-text",{staticClass:"num"},[t._v(t._s(i.comments))])],1),e("v-uni-view",{staticClass:"ls",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.shares(n)}}},[e("v-uni-text",{staticClass:"iconfont icon-share"}),e("v-uni-text",{staticClass:"num"},[t._v(t._s(i.shares))])],1)],1)],1)],1)],1)]})],2)],1),e("video-cart",{ref:"videoCart",attrs:{vlist:t.vlist}}),e("video-comment",{ref:"videoComment",attrs:{vlist:t.vlist}}),e("uni-pop",{ref:"uniPop"})],1)},a=[];e.d(i,"b",function(){return s}),e.d(i,"c",function(){return a}),e.d(i,"a",function(){return n})},"963d":function(t,i,e){"use strict";e.r(i);var n=e("3aec"),s=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(i,t,function(){return n[t]})}(a);i["default"]=s.a},af85:function(t,i,e){"use strict";e.r(i);var n=e("4337"),s=e("963d");for(var a in s)"default"!==a&&function(t){e.d(i,t,function(){return s[t]})}(a);var o,l=e("f0c5"),c=Object(l["a"])(s["default"],n["b"],n["c"],!1,null,"4c2a8844",null,!1,n["a"],o);i["default"]=c.exports}}]);